/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * 'License'); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * 'AS IS' BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */

/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */

define("core/rave_ajax",["jquery"],function(e){var t=e.ajax;return t}),define("core/rave_state_manager",[],function(){var e,t,n,r,i,s=200,o=320,u="default",a=!1,f={};return f.setPage=function(t){e=t},f.getPage=function(){return e},f.setViewer=function(e){t=e},f.getViewer=function(){return t},f.setOwner=function(e){n=e},f.getOwner=function(){return n},f.setContext=function(e){r=e},f.getContext=function(){return r},f.setExportEnabled=function(e){i=e},f.getExportEnabled=function(){return i},f.setDefaultHeight=function(e){s=e},f.getDefaultHeight=function(){return s},f.setDefaultWidth=function(e){o=e},f.getDefaultWidth=function(){return o},f.setDefaultView=function(e){u=e},f.getDefaultView=function(){return u},f.setDebugMode=function(e){a=e},f.getDebugMode=function(){return a},f}),define("core/rave_event_manager",["underscore"],function(e){var t=!1,n=[],r={};return r.registerOnInitHandler=function(r){if(!e.isFunction(r))throw new Error("Init event handler must be a function");if(t)return r();n.push(r)},r.init=function(){t=!0,e.each(n,function(e){e()})},r}),define("core/rave_api",["underscore","core/rave_ajax","core/rave_state_manager","core/rave_event_manager"],function(e,t,n,r){function s(e,t,n){alert(n)}var i="";r.registerOnInitHandler(function(){i=n.getContext()});var o=function(){function n(n){var r={preferences:[]};for(var o in n.userPrefs)r.preferences.push({name:o,value:n.userPrefs[o]});t({type:"PUT",url:i+e+"regionWidgets/"+n.regionWidgetId+"/preferences",data:JSON.stringify(r),contentType:"application/json",dataType:"json",success:function(e){typeof n.successCallback=="function"&&n.successCallback()},error:s})}function r(n){t({type:"PUT",url:i+e+"regionWidgets/"+n.regionWidgetId+"/preferences/"+n.prefName,data:JSON.stringify({name:n.prefName,value:n.prefValue}),contentType:"application/json",dataType:"json",success:function(e){typeof n.successCallback=="function"&&n.successCallback()},error:s})}function o(n){t({type:"PUT",url:i+e+"regionWidgets/"+n.regionWidgetId+"/collapsed",data:JSON.stringify(n.collapsed),contentType:"application/json",dataType:"json",success:n.successCallback,error:s})}function u(n){t({type:"DELETE",url:i+e+"page/"+n.pageId,success:function(e){typeof n.successCallback=="function"&&n.successCallback()},error:s})}function a(n){t({type:"DELETE",url:i+e+"widgets/"+n.widgetId+"/rating",success:function(e){typeof n.successCallback=="function"&&n.successCallback()},error:s})}function f(n){t({type:"POST",url:i+e+"widgets/"+n.widgetId+"/rating?score="+n.score,success:function(e){typeof n.successCallback=="function"&&n.successCallback()},error:s})}function l(n){t({type:"POST",url:i+e+"widgets/"+n.widgetId+"/comments?text="+escape(n.text),success:function(e){typeof n.successCallback=="function"&&n.successCallback()},error:s})}function c(n){t({type:"DELETE",url:i+e+"widgets/"+n.widgetId+"/comments/"+n.commentId,success:function(e){typeof n.successCallback=="function"&&n.successCallback()},error:s})}function h(n){t({type:"POST",url:i+e+"widgets/"+n.widgetId+"/comments/"+n.commentId+"?text="+escape(n.text),success:function(e){typeof n.successCallback=="function"&&n.successCallback()},error:s})}function p(n){t({type:"GET",url:i+e+"widgets/"+n.widgetId+"/users",success:function(e){typeof n.successCallback=="function"&&n.successCallback(e)},error:s})}function d(n){t({type:"POST",url:i+e+"widgets/"+n.widgetId+"/tags?tagText="+escape(n.text),success:function(e){typeof n.successCallback=="function"&&n.successCallback()},error:s})}function v(n){t({type:"GET",url:i+e+"widgets/"+n.widgetId+"/tags",dataType:"json",success:function(e){typeof n.successCallback=="function"&&n.successCallback(e)}})}function m(e){t({type:"GET",url:i+"api/rest/opensocial/gadget?url="+e.url+"&pageid="+e.pageid,dataType:"json",success:function(t){typeof e.successCallback=="function"&&e.successCallback(t)}})}var e="api/rest/";return{updateWidgetRating:f,deleteWidgetRating:a,saveWidgetPreferences:n,saveWidgetPreference:r,saveWidgetCollapsedState:o,createWidgetComment:l,updateWidgetComment:h,deleteWidgetComment:c,deletePage:u,getUsersForWidget:p,createWidgetTag:d,getTags:v,getSecurityToken:m}}(),u=function(){function r(e){t({type:"POST",url:i+n+"page/regionWidget/"+e.regionWidgetId+"/move",data:{newPosition:e.toIndex,toRegion:e.toRegionId,fromRegion:e.fromRegionId},dataType:"json",success:function(e){e.error&&d(e)},error:s})}function o(e){t({type:"POST",url:i+n+"page/"+e.pageId+"/widget/add",data:{widgetId:e.widgetId},dataType:"json",success:function(t){if(t.error)d(t);else{var n=t.result!=undefined?t.result.widgetId:undefined;e.successCallback&&n!=undefined&&e.successCallback(t.result)}},error:s})}function u(r){t({type:"POST",url:i+n+"page/regionWidget/"+r.regionWidgetId+"/delete",data:null,dataType:"json",success:function(t){t.error?d(t):e.isFunction(r.successCallback)&&r.successCallback()},error:s})}function a(e){t({type:"POST",url:i+n+"page/add",data:{pageName:e.pageName,pageLayoutCode:e.pageLayoutCode},dataType:"json",success:function(t){t.error?t.errorCode=="DUPLICATE_ITEM"?typeof e.errorCallback=="function"&&e.errorCallback(e.errorLabel):d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function f(e){t({type:"GET",url:i+n+"page/get",data:{pageId:e.pageId},dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function l(e){var r={};e.moveAfterPageId&&(r.moveAfterPageId=e.moveAfterPageId),t({type:"POST",url:i+n+"page/"+e.pageId+"/move",data:r,dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function c(e){var r={};e.toPageId&&(r.toPageId=e.toPageId,r.regionWidgetId=e.regionWidgetId),t({type:"POST",url:i+n+"page/"+e.toPageId+"/moveWidget",data:r,dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function h(e){t({type:"POST",url:i+n+"page/"+e.pageId+"/update",data:{name:e.title,layout:e.layout},dataType:"json",success:function(t){t.error?t.errorCode=="DUPLICATE_ITEM"?typeof e.errorCallback=="function"&&e.errorCallback(e.errorLabel):d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function p(e){t({type:"GET",url:i+n+"page/get?pageId="+e.pageId,dataType:"json",success:function(t){typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function d(e){switch(e.errorCode){case"NO_ERROR":break;case"INVALID_PARAMS":alert(e);break;case"INTERNAL_ERROR":alert(e)}}function v(e){var r=e.url,o=e.providerType;if((r==null||o==null)&&typeof e.alertInvalidParams=="function"){e.alertInvalidParams();return}t({type:"POST",url:i+n+"widget/metadata/get",data:{url:r,type:o},dataType:"json",success:function(t){t.error&&typeof e.errorCallback=="function"?e.errorCallback():typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function m(e){var r=e.url,o=e.providerType;if((r==null||o==null)&&typeof e.alertInvalidParams=="function"){e.alertInvalidParams();return}t({type:"POST",url:i+n+"widget/metadatagroup/get",data:{url:r,type:o},dataType:"json",success:function(t){t.error&&typeof e.errorCallback=="function"?e.errorCallback():typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function g(e){t({type:"GET",url:i+n+"widget/getall",dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function y(e){var r=e.offset;t({type:"GET",url:i+n+"person/get",data:{offset:r},dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function b(e){var r=e.searchTerm,o=e.offset;if((r==null||r=="")&&typeof e.alertEmptySearch=="function"){e.alertEmptySearch();return}t({type:"GET",url:i+n+"person/search",data:{searchTerm:r,offset:o},dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function w(e){t({type:"POST",url:i+n+"page/"+e.pageId+"/clone",data:{userId:e.userId,pageName:e.pageName},dataType:"json",success:function(t){typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function E(e){t({type:"POST",url:i+n+"page/"+e.pageId+"/addmember",data:{userId:e.userId},dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function S(e){t({type:"POST",url:i+n+"page/"+e.pageId+"/removemember",data:{userId:e.userId},dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function x(e){t({type:"POST",url:i+n+"page/"+e.pageId+"/sharestatus",data:{shareStatus:e.shareStatus},dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function T(e){t({type:"POST",url:i+n+"page/"+e.pageId+"/editstatus",data:{userId:e.userId,isEditor:e.isEditor},dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function N(e){var r=encodeURIComponent(encodeURIComponent(e.friendUsername));t({type:"POST",url:i+n+"person/"+r+"/addfriend",data:null,dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function C(e){var r=encodeURIComponent(encodeURIComponent(e.friendUsername));t({type:"POST",url:i+n+"person/"+r+"/removefriend",data:null,dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function k(e){t({type:"POST",url:i+n+"person/getFriends",data:null,dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function L(e){var r=encodeURIComponent(encodeURIComponent(e.friendUsername));t({type:"POST",url:i+n+"person/"+r+"/acceptfriendrequest",data:null,dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}function A(e){t({type:"POST",url:i+n+"marketplace/add",data:{url:e.url,providerType:e.providerType},dataType:"json",success:function(t){t.error?d(t):typeof e.successCallback=="function"&&e.successCallback(t)},error:s})}var n="api/rpc/";return{moveWidgetToRegion:r,addWidgetToPage:o,removeWidget:u,addPage:a,getPage:f,updatePagePrefs:h,getPagePrefs:p,movePage:l,moveWidgetToPage:c,getWidgetMetadata:v,getWidgetMetadataGroup:m,getUsers:y,searchUsers:b,clonePageForUser:w,addMemberToPage:E,removeMemberFromPage:S,updateSharedPageStatus:x,updatePageEditingStatus:T,addFriend:N,removeFriend:C,getFriends:k,acceptFriendRequest:L,addWidgetFromMarketplace:A,getAllWidgets:g}}(),a={rest:o,rpc:u};return a}),define("core/rave_view_manager",["underscore"],function(e){var t={},n={},r={};return r.registerView=function(e,n){t[e.toLowerCase()]=n},r.getView=function(e){return t[e.toLowerCase()]},r.renderView=function(t){var i=e.toArray(arguments).slice(1),s=r.getView(t);if(!s)throw new Error("Attempted to render undefined view: "+t);return e.isFunction(s)&&(s=new s(i[0])),s.render.apply(s,i),s._uid=e.uniqueId("rave_view_"),n[s._uid]=s,s},r.getRenderedView=function(e){return n[e]},r.destroyView=function(t){var i=e.toArray(arguments).slice(1);e.isString(t)&&(t=r.getRenderedView(t)),delete n[t._uid],t.destroy(i)},r.reset=function(){t={}},r}),define("core/rave_log",[],function(){var e=function(e){console&&console.log&&console.log(e)};return e}),define("core/rave_openajax_hub",["underscore","core/rave_log","osapi"],function(e,t){if(e.isUndefined(OpenAjax))throw new Error("No implementation of OpenAjax found.  Please ensure that an implementation has been included in the page.");var n=new OpenAjax.hub.ManagedHub({onSubscribe:function(e,n){return t((n==null?"Container":n.getClientID())+" subscribes to this topic '"+e+"'"),!0},onUnsubscribe:function(e,n){return t((n==null?"Container":n.getClientID())+" unsubscribes from this topic '"+e+"'"),!0},onPublish:function(e,n,r,i){return t((r==null?"Container":r.getClientID())+" publishes '"+n+"' to topic '"+e+"' subscribed by "+(i==null?"Container":i.getClientID())),!0}});return n}),define("core/rave_wookie",["core/rave_openajax_hub","core/rave_state_manager"],function(e,t){function r(e,t){}function i(e){}function s(e){}var n={};return n.initWidget=function(e){},n.renderWidget=function(n,o,u){var a=document.getElementById(["widget-",n.regionWidgetId,"-body"].join(""));window["onWidget"+n.regionWidgetId+"Load"]=function(){window.document.getElementById(n.regionWidgetId).style.visibility="visible"},new OpenAjax.hub.IframeContainer(e,""+n.regionWidgetId,{Container:{onSecurityAlert:r,onConnect:i,onDisconnect:s},IframeContainer:{parent:o,iframeAttrs:{height:n.height||t.getDefaultHeight(),width:n.width||t.getDefaultWidth(),frameborder:0},uri:n.widgetUrl,onGadgetLoad:"onWidget"+n.regionWidgetId+"Load"}})},n.closeWidget=function(e){},n}),define("core/rave_action_manager",["underscore"],function(e){var t=[],n={};return n.createAction=function(n,r,i,s,o,u,a){e.invoke(t,"create",n,r,i,s,o,u,a)},n.removeAction=function(n){e.invoke(t,"remove",n)},n.registerActionHandler=function(e){t.push(e)},n}),define("core/rave_opensocial",["underscore","core/rave_view_manager","core/rave_api","core/rave_openajax_hub","core/rave_log","core/rave_state_manager","core/rave_action_manager","osapi"],function(e,t,n,r,i,s,o){function l(){a.rpcRegister("requestNavigateTo",p),a.rpcRegister("set_pref",d),a.rpcRegister("set_title",v),a.rpcRegister("hideWidget",m),a.rpcRegister("showWidget",g)}function c(){a.views.createElementForGadget=function(e,n,r,i,s,o,u){if(i){var a=e&&e.views&&e.views[r],f=t.renderView(i,a),l=f.getWidgetSite();return l.setAttribute("data-rave-view",f._uid),l}},a.views.createElementForEmbeddedExperience=function(e,r,o,u,a,f){function c(e){if(e.error)return i(e.error.message);var n={widgetUrl:l,securityToken:e.securityToken,metadata:r},s=y(n.metadata.modulePrefs),u=b(n.metadata.modulePrefs);E(n);if(o){var a=t.renderView(o,{preferredHeight:s,preferredWidth:u}),c=a.getWidgetSite();c.setAttribute("data-rave-view",a._uid),f(c)}}var l=r.url;n.rest.getSecurityToken({url:l,pageid:s.getPage().id,successCallback:c})},a.views.createElementForUrl=function(e,n,r,i,s){if(n){var o=t.renderView(n),u=o.getWidgetSite();u.setAttribute("data-rave-view",o._uid),s(u)}},a.views.destroyElement=function(e){var n=e.el_;a.closeGadget(e);var r=n.getAttribute("data-rave-view");t.destroyView(r)}}function h(){if(!a.actions){i("Could not initialize actions as the feature is not enabled in the Shindig common container.  Check the rave properties file.");return}a.actions.registerShowActionsHandler(function(t){e.each(t,function(e){o.createAction(e.id,e.label,e.path.replace("gadget","widget"),e.moduleId,e.icon,e.tooltip,function(){var t=a._siteByWidgetId[e.moduleId],n=t.getActiveSiteHolder();n&&gadgets.rpc.call(n.getIframeId(),"actions.runAction",null,e.id,null)})})}),a.actions.registerHideActionsHandler(function(t){e.each(t,function(e){o.removeAction(e.id)})})}function p(e,n,r,i){var s=e.gs._widget,o=n.split(".")[0],u=t.getView(o)?o:s._el;s._el.id===""&&t.destroyView(s._view),s.render(u,{view:n,view_params:r,ownerId:i})}function d(e,t,n,r){var i=e.gs._widget;i.savePreference(n,r)}function v(t){var n=t.gs._widget;if(n._view&&n._view.setTitle){var r=e.isArray(t.a)?t.a[0]:t.a;n._view.setTitle(r)}}function m(e,t,n,r){var i=e.gs._widget;i._view&&i._view.collapse&&i._view.collapse()}function g(e,t,n,r){var i=e.gs._widget;i._view&&i._view.expand&&i._view.expand()}function y(e){var t;return e.height?t=e.height:e.preferredHeight?t=e.preferredHeight:t=s.getDefaultHeight(),t}function b(e){var t;return e.width?t=e.width:e.preferredWidth?t=e.preferredWidth:t=s.getDefaultWidth(),t}function w(t,n){var r={};return e.each(n,function(n){var i=t[n.name];r[n.name]=e.isUndefined(i)?n.defaultValue:i}),r}function E(e){var t={};t[e.widgetUrl]=e.metadata;var n={};n[osapi.container.TokenResponse.TOKEN]=e.securityToken,n[osapi.container.MetadataResponse.RESPONSE_TIME_MS]=(new Date).getTime();var r={};r[e.widgetUrl]=n,r[e.widgetUrl+"#moduleId="+e.regionWidgetId]=n;var i={};i[osapi.container.ContainerConfig.PRELOAD_METADATAS]=t,i[osapi.container.ContainerConfig.PRELOAD_TOKENS]=r,i[osapi.container.ContainerConfig.PRELOAD_REF_TIME]=null,a.preloadCaches(i)}function S(e){return e.error}var u={},a,f={};return f[osapi.container.ServiceConfig.API_PATH]="/rpc",f[osapi.container.ContainerConfig.RENDER_DEBUG]=s.getDebugMode(),a=new osapi.container.Container(f),a._siteByWidgetId={},gadgets.pubsub2router.init({hub:r}),l(),c(),h(),u.initWidget=function(e){e.error=S(e.metadata),e.error||E(e)},u.renderWidget=function(e,t,n){if(e.error){e.renderError(t,e.error.message);return}n=n||{};var r=a.newGadgetSite(t);r._widget=e,r.moduleId_=e.regionWidgetId,e._site=r,a._siteByWidgetId[e.regionWidgetId]=r;var i={};i[osapi.container.RenderParam.VIEW]=n.view||s.getDefaultView(),i[osapi.container.RenderParam.ALLOW_DEFAULT_VIEW]=n.allowDefaultView,i[osapi.container.RenderParam.DEBUG]=n.debug||s.getDebugMode(),i[osapi.container.RenderParam.HEIGHT]=y(n),i[osapi.container.RenderParam.NO_CACHE]=n.noCache||s.getDebugMode(),i[osapi.container.RenderParam.TEST_MODE]=n.testMode||s.getDebugMode(),i[osapi.container.RenderParam.WIDTH]=b(n),i[osapi.container.RenderParam.USER_PREFS]=w(e.userPrefs,e.metadata.userPrefs),i[osapi.container.RenderParam.MODULE_ID]=e.regionWidgetId,a.navigateGadget(r,e.widgetUrl,n.view_params,i,n.callback)},u.closeWidget=function(e){e._site&&a.closeGadget(e._site)},u.getContainer=function(){return a},u}),define("core/rave_providers",["core/rave_wookie","core/rave_opensocial"],function(e,t){var n={};return n.w3c=e,n.opensocial=t,n}),define("core/rave_widget",["underscore","core/rave_api","core/rave_view_manager","core/rave_providers"],function(e,t,n,r){function i(e){return r[e.toLowerCase()]}var s=function(t){var n=t.type;e.extend(this,t),this._provider=i(n);if(!this._provider)throw new Error("Cannot render widget "+t.widgetUrl+". "+"Provider "+n+" is not registered.");this._provider.initWidget(this)};return isHTMLElement=function(){return window.HTMLElement?function(e){return e instanceof HTMLElement}:function(e){return e.nodeType&&e.nodeType==1}}(),s.extend=function(t){e.extend(this.prototype,t)},s.prototype.render=function(t,r){!r&&!e.isString(t)&&!isHTMLElement(t)&&(r=t,t=this._el);if(e.isString(t)){var i=n.renderView(t,this);t=i.getWidgetSite(),this._view=i}if(!isHTMLElement(t))throw new Error("Cannot render widget. You must provide an el to render the view into");return this._el=t,this._provider.renderWidget(this,t,r),this},s.prototype.renderError=function(e,t){e.innerHTML="Error rendering widget.<br /><br />"+t},s.prototype.hide=function(){this.collapsed=!0,t.rest.saveWidgetCollapsedState({regionWidgetId:this.regionWidgetId,collapsed:this.collapsed})},s.prototype.show=function(){this.collapsed=!1,t.rest.saveWidgetCollapsedState({regionWidgetId:this.regionWidgetId,collapsed:this.collapsed})},s.prototype.close=function(e){this._provider.closeWidget(this,e),this._view&&n.destroyView(this._view),t.rpc.removeWidget({regionWidgetId:this.regionWidgetId})},s.prototype.moveToPage=function(e,n){t.rpc.moveWidgetToPage({toPageId:e,regionWidgetId:this.regionWidgetId,successCallback:n})},s.prototype.moveToRegion=function(e,n,r){t.rpc.moveWidgetToRegion({regionWidgetId:this.regionWidgetId,fromRegionId:e,toRegionId:n,toIndex:r})},s.prototype.savePreference=function(e,n){this.userPrefs[e]=n,t.rest.saveWidgetPreference({regionWidgetId:this.regionWidgetId,prefName:e,prefValue:n})},s.prototype.savePreferences=function(e){this.userPrefs=e,t.rest.saveWidgetPreferences({regionWidgetId:this.regionWidgetId,userPrefs:e})},s}),define("core/rave_widget_manager",["underscore","core/rave_widget"],function(e,t){var n={},r={};return r.registerWidget=function(e,r){return r?r.regionId=e:r=e,n[r.regionWidgetId]=new t(r),n[r.regionWidgetId]},r.unregisterWidget=function(e){var t=e.regionWidgetId||e;delete n[t]},r.renderWidgets=function(t,n){e.invoke(r.getWidgets(),"render",t,n)},r.getWidget=function(e){return n[e]},r.getWidgets=function(t){var r=e.toArray(n);return t&&(r=e.where(r,t)),r},r}),define("rave",["underscore","core/rave_widget_manager","core/rave_api","core/rave_widget","core/rave_log","core/rave_event_manager","core/rave_view_manager","core/rave_state_manager","core/rave_openajax_hub","core/rave_action_manager"],function(e,t,n,r,i,s,o,u,a,f){var l={};return l.api=n,l.RegionWidget=r,l.log=i,l.getManagedHub=function(){return a},e.extend(l,s),e.extend(l,o),e.extend(l,t),e.extend(l,u),e.extend(l,f),l});